⭕**Расчет_задолженностей_по_листам_Google_Sheets**

Скрипт для расчета задолженностей, который принимает три списка (данные с каждого листа в Google Sheets) и сохраняет отчет в файл student_debt_report.txt.

Расчет долгов осуществляется по формуле: ((текущая_дата - дата_последнего_платежа)//182)*сумма_платежа. Если расчет долга превышает размер остаток задолженности, то используется последнее значение.

Поскольку возможны неплательщики, которые пропустили уже несколько платежей, то их долг должен быть больше, чем простой разовый платеж. Периоды внесения платежей для всех студентов одинаковы - 6 месяцев (183 дня).

Подключение к таблице осуществляется через Google Sheets API.

Небольшое описание столбцов в таблицах:

Лист1: student_id - id студента; student_name - имя студента; installment (Y/N) - факт наличия рассрочки у студента (Y - рассрочка есть, N - рассрочки нет).

Лист2: student_id - idстудента; last_payment_date - дата последней полученной оплаты; expected_payment_date - дата, в которую ожидаем следующий платеж (рассчитывается от даты последнего платежа).

Лист3: student_id - id студента; already_payed_amount - уже выплаченная часть рассрочки; left_to_pay - оставшаяся (невыплаченная) часть; one-time_payment - единоразовый платеж; installment_amount - общая сумма, которая бралась в рассрочку.

**_Примерный результат выполенения:_**

Авторизация в Google API

Проверка доступности листов

Доступные листы в таблице: ['Лист1', 'Лист2', 'Лист3']

Загрузка данных из таблицы...

Фильтрация студентов с installment='Y'...

Найдено 253 студентов с рассрочкой

Расчет задолженностей...

Сохранение результатов в файл student_debt_report.txt...

Файл сохранен: student_debt_report.txt

Результаты: 166 студентов с долгом

Студент Кузнецова К.А. - долг 266666 рублей

Студент Петров К.А. - долг 66666 рублей

Студент Иванов А.А. - долг 100000 рублей
